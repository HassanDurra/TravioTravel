
@{
    ViewData["title"] = "All Flight Bookings";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
    var bookingDetails = Newtonsoft.Json.JsonConvert.SerializeObject(ViewBag.Data);
    var bookingData = Newtonsoft.Json.JsonConvert.DeserializeObject(bookingDetails);
}
<div class="card">
    <div class="card-header d-flex">


        <h4 class="card-title">All Airline Services</h4>
       

    </div>
    <div class="card-body">
        <div class="table-responsive">
            <table id="example4" class="display" style="min-width:100%">
                <thead>
                    <tr>
                        <th>Tracking Number</th>
                        <th>Airline Image</th>
                        <th>Airline Name</th>
                        <th>Passanger Image</th>
                        <th>Passanger Name</th>
                        <th>Passanger Email</th>
                        <th>Passport</th>
                        <th>CNIC Number</th>
                        <th>Departure From</th>
                        <th>Arrival To</th>
                        <th>Ticket Price</th>
                        <th>Class Type</th>
                        <th>Departure Date</th>
                        <th>Departure Time</th>
                        <th>Arrival Date</th>
                        <th>Arrival Time</th>
                        <th>Passanger Country</th>
                        <th>Passanger Age</th>
                        <th>Booking Date</th>
                        <th>Status</th>
                        <th>Re-Scheduled</th>
                        <th>Print Ticket</th>
                        <th>Cancel Booking</th>
                        <th>Remove Booking</th>

                    </tr>
                </thead>
                <tbody>
                    @foreach(var bookings in @bookingData)
                    {   <tr>
                            <td>@bookings.passangers.Booking_Number</td>
                            <td><img src="@bookings.flights.airline_image" style="width:40px ; height:40px; object-fit:contain " /></td>
                            <td>@bookings.flights.airline_name</td>
                            <td><center><img src="~/PassangersImages/@bookings.passangers.image" style="width:40px ; height:40px; object-fit:cover ;" /></center></td>
                            <td>@bookings.passangers.firstName &nbsp; @bookings.passangers.lastName </td>
                            <td>@bookings.passangers.email </td>
                            <td>@bookings.passangers.passport_number </td>
                            <td>@bookings.passangers.Cnic_number </td>
                            
                            <td>@bookings.flights.from </td>
                            <td>@bookings.flights.to </td>
                            <td>@bookings.flights.total_price </td>
                            <td>@bookings.flights.class_type </td>
                            <td>@bookings.flights.departure_date </td>
                            <td>@bookings.flights.departure_time </td>
                            <td>@bookings.flights.arrival_date </td>
                            <td>@bookings.flights.arrival_time </td>
                            <td>@bookings.passangers.country_name </td>
                            <td>@bookings.passangers.age </td>
                            <td>@bookings.passangers.created_at </td>
                            <td>
                                 @if(@bookings.passangers.status == 0)
                                {
                                    <a href="@Url.Action("Departed" , "Bookings" , new { id = @bookings.passangers.id})" class="btn btn-secondary text-white" title="Scheduled"><i class="fa fa-calendar-check"></i></a>
                                }
                                else if(@bookings.passangers.status == 1)
                                {
                                    <a href="@Url.Action("Arrived" , "Bookings" , new { id = @bookings.passangers.id})"  class="btn btn-warning text-white" title="Departed"><i class="fa fa-plane-departure"></i></a>
                                }
                                else if(@bookings.passangers.status == 2)
                                {
                                    <a class="btn btn-success text-white" title="Arrived"><i class="fa fa-plane-arrival"></i></a>
                                }
                                else if (@bookings.passangers.status == 3)
                                {
                                    <a class="btn btn-danger text-white" title="Cancelled"><i class="fa fa-ban"></i></a>
                                }
                               
                            </td>
                            <td>
                                @if(@bookings.passangers.status == 0){
                                    <a href="@Url.Action("Scheduled" , "Bookings" , new { id = @bookings.passangers.flight_details_id})" class="btn btn-success text-white" title="Re-Schedule Ticket"><i class="fa fa-clock"></i></a>
                                }
                                else
                                {
                                    <a href="#" class="btn btn-danger text-white" title="Cannot Re-Scheduled"><i class="fa fa-clock"></i></a>
                                }

                            </td>
                              <td>
                                    <a class="btn btn-warning text-white" title="Print Ticket"><i class="fa fa-print"></i></a>
                              
                               
                            </td>
                            <td>
                                @if (@bookings.passangers.status == 0)
                                {
                                    <a class="btn btn-danger" href="@Url.Action("Cancel" , "Bookings" , new { id = @bookings.passangers.id  , Status ="Scheduled"})" disabled title="Cancel Booking"><i class="fa fa-ban"></i></a>
                                }
                                else
                                {
                                    <a class="btn btn-danger" href="@Url.Action("Cancel" , "Bookings" , new { id = @bookings.passangers.id  , Status ="DepartedOrArrived"})" disabled title="Cannot Cancel Booking"><i class="fa fa-ban"></i></a>
                                }
                            </td>
                            <td>
                               @if(@bookings.passangers.status == 1){
                                    <a class="btn btn-danger" href="@Url.Action("RemoveTicketTicket" , "Bookings" , new { id = @bookings.passangers.id , Status ="invalid"})" title="Remove Booking"><i class="fa fa-trash"></i></a>
                                }
                                else
                                {
                                    <a class="btn btn-danger" href="@Url.Action("RemoveTicket" , "Bookings" , new { id = @bookings.passangers.id , Status ="valid"})" title="Remove Booking"><i class="fa fa-trash"></i></a>
                                }
                            </td>
                        </tr>
                    }


                </tbody>
            </table>
        </div>
    </div>
</div>
<!-- Scripts start -->
<!--**********************************
        Main wrapper end
    ***********************************-->
<!--**********************************
    Scripts

<!-- Required vendors -->
<script src="~/dashboardassets/vendor/global/global.min.js"></script>

<script src="~/dashboardassets/vendor/jquery-nice-select/js/jquery.nice-select.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
<!-- Custom -->
<script src="~/dashboardassets/custom/js/Countries.js"></script>
<!-- Apex Chart -->

<script src="~/dashboardassets/vendor/apexchart/apexchart.js"></script>


<!-- Chart piety plugin files -->
<!-- Dashboard 1 -->
<script src="~/dashboardassets/js/dashboard/dashboard-1.js"></script>

<script src="~/dashboardassets/vendor/owl-carousel/owl.carousel.js"></script>
<script src="~/dashboardassets/vendor/global/global.min.js"></script>
<script src="~/dashboardassets/vendor/chart.js/Chart.bundle.min.js"></script>
<!-- Apex Chart -->
<script src="~/dashboardassets/vendor/apexchart/apexchart.js"></script>

<!-- Datatable -->
<script src="~/dashboardassets/vendor/datatables/js/jquery.dataTables.min.js"></script>
<script src="~/dashboardassets/js/plugins-init/datatables.init.js"></script>

<script src="~/dashboardassets/vendor/jquery-nice-select/js/jquery.nice-select.min.js"></script>

<script src="~/dashboardassets/js/custom.min.js"></script>
<script src="~/dashboardassets/js/dlabnav-init.js"></script>
<script src="~/dashboardassets/js/demo.js"></script>
<script src="~/dashboardassets/js/styleSwitcher.js"></script>
